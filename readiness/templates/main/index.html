<!DOCTYPE html>
{% load static %}
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Readiness Dashboard</title>
    <script src="{% static 'main/jquery/jquery.min.js' %}"></script>
    <link rel="stylesheet" href="{% static 'main/jquery-ui/jquery-ui.structure.min.css' %}">
    <link rel="stylesheet" href="{% static 'main/jquery-ui/jquery-ui.theme.min.css' %}">
    <script src="{% static 'main/jquery-ui/jquery-ui.min.js' %}"></script>

    <!--https://github.com/xdan/datetimepicker/tree/master/build-->
    <script src="{% static 'main/jquery-datetimepicker/jquery.datetimepicker.js' %}"></script>
    <link rel="stylesheet" href="{% static 'main/jquery-datetimepicker/jquery.datetimepicker.css' %}">

    <style>
            /* The sidebar menu */
            .sidenav {
              height: 100%; /* Full-height: remove this if you want "auto" height */
              width: 300px; /* Set the width of the sidebar */
              position: fixed; /* Fixed Sidebar (stay in place on scroll) */
              z-index: 1; /* Stay on top */
              top: 0; /* Stay at the top */
              left: 0;
              background-color: #eee;
              overflow-x: auto; /* Disable horizontal scroll */
              padding-top: 20px;
            }

            /* The navigation menu links */
            .sidenav a {
              padding: 6px 8px 6px 16px;
              text-decoration: none;
              font-size: 25px;
              color: #818181;
              display: block;
            }

            /* When you mouse over the navigation links, change their color */
            .sidenav a:hover {
              color: #f1f1f1;
            }

            /* Style page content */
            .main {
              margin-left: 300px; /* Same as the width of the sidebar */
              padding: 0px 10px;
            }

            /* On smaller screens, where height is less than 450px, change the style of the sidebar (less padding and a smaller font size) */
            @media screen and (max-height: 450px) {
              .sidenav {padding-top: 15px;}
              .sidenav a {font-size: 18px;}
            }

            label.ui-checkboxradio-label {
                width: 75px !important;
            }

            #generate {
              margin-left: 12%;
              width: 75%;
              padding: 10px;
            }

            fieldset {
                border-color: white;
            }

            fieldset legend {
                color: darkslateblue;
            }

    </style>

    <script>

            //  This function communicates with django (backend)

            function date_to_dt(d, zero_hours=true) {
                var components =  d.toISOString().split('T');
                var hours = components[1].split(':')[0];
                if (zero_hours) {
                    hours = "00";
                }
                return components[0] + ":" + hours + ":00";
            }

            function generate_report() {
                var basis_release = $("#basis_release").val();
                var basis_start_dt = $("#basis_start_dt").val();
                var basis_end_dt = $("#basis_end_dt").val();

                var sample_release = $("#sample_release").val();
                var sample_start_dt = $("#sample_start_dt").val();
                var sample_end_dt = $("#sample_end_dt").val();

                var group_by = ""
                $(".group-by-checkbox").each(function() {
                    if ($(this).is(':checked')) {
                        group_by += $(this).val() + ",";
                    }
                })

                if (!basis_start_dt || !basis_end_dt || !sample_start_dt || !sample_end_dt || group_by == "") {
                    return;
                }
                document.querySelector('#content').innerHTML = "Generating report...";

                $( "#content" ).load( '/main/report?group_by=' + group_by + '&sample_release=' + sample_release + '&basis_release=' + basis_release + '&sample_start_dt=' + sample_start_dt + '&sample_end_dt=' + sample_end_dt + '&basis_start_dt=' + basis_start_dt + '&basis_end_dt=' + basis_end_dt + '&from_index=1', function() {
                    // make all links in tables generated by the index create a new tab in the browser
                    $('#content table a').attr("target","_blank");
                });

            }

            /*
            document.addEventListener("DOMContentLoaded", function() {
                document.querySelectorAll('button').forEach(button => {
                    button.onclick = function() {
                        showSection(this.dataset.section)
                    }
                })
            }); */

            $( function() {
                $( ".basis_control_group" ).controlgroup();
                $( ".sample_control_group" ).controlgroup();

                $('.dtp').datetimepicker({
                  format:'Y-m-d:H:i',
                  onChangeDateTime:function(dp,$input){
                    // showReport();
                  }
                });

                $('.selectmenu').selectmenu({
                  change: function( event, ui ) {
                      // showReport();
                  }
                });

                $('#group-by').buttonset();

                $( "input[type=checkbox]" ).checkboxradio({
                    icon: false,
                });

                $( "input[type=checkbox]" ).change(function(event) {
                    // showReport();
                });


                var now = new Date();
                var last48 = new Date(now - (48 * 60 * 60 * 1000));
                var last5d = new Date(now - (5 * 24 * 60 * 60 * 1000));

                $("#basis_start_dt").val(date_to_dt(last5d));
                $("#basis_end_dt").val(date_to_dt(last48));
                $("#sample_start_dt").val(date_to_dt(last48));
                $("#sample_end_dt").val(date_to_dt(now));
                // showReport();

                $( "#accordion" ).accordion();
            } );


    </script>
</head>
<body>
<div class="sidenav">
    <button id="generate" class="ui-button ui-widget ui-corner-all" onclick="generate_report()">Generate Report</button>
    <br>
    <br>

    <fieldset style="display:inline-block;">
        <legend>Historical Comparison Basis</legend>
        <div class="basis_control_group">
            <label for="basis_release">Release</label>
            <select name="basis_release" id="basis_release" class="selectmenu">
                <option>4.10</option>
                <option>4.11</option>
                <option>4.12</option>
                <option>4.13</option>
                <option selected="selected">4.14</option>
            </select>
            <br>
            <br>

            <div>Date Range:</div>
            <input class="dtp" id="basis_start_dt" type="text">
            <input class="dtp" id="basis_end_dt" type="text">
        </div>
    </fieldset>

    <fieldset style="display:inline-block;">
        <legend>Test Sample</legend>
        <div class="sample_control_group">
            <label for="sample_release">Release</label>
            <select name="sample_release" id="sample_release" class="selectmenu">
                <option>4.10</option>
                <option>4.11</option>
                <option>4.12</option>
                <option>4.13</option>
                <option selected="selected">4.14</option>
            </select>
            <br>
            <br>

            <div>Date Range:</div>
            <input class="dtp" id="sample_start_dt" type="text">
            <input class="dtp" id="sample_end_dt" type="text">
        </div>
    </fieldset>

    <div id="accordion">
        <h3>Group By</h3>
        <div>
            <label for="gbc-cloud">Cloud</label>
            <input class="group-by-checkbox" type="checkbox" name="checkbox-1" id="gbc-cloud" value="cloud" checked="checked">
            <label for="gbc-arch">Arch</label>
            <input class="group-by-checkbox"  type="checkbox" name="checkbox-2" id="gbc-arch" value="arch" checked="checked">

            <br>

            <label for="gbc-network">Network</label>
            <input class="group-by-checkbox"  type="checkbox" name="checkbox-3" id="gbc-network" value="network" checked="checked">
            <label for="gbc-upgrade">Upgrade</label>
            <input class="group-by-checkbox"  type="checkbox" name="checkbox-4" id="gbc-upgrade" value="upgrade">
        </div>
        <h3>Section 2</h3>
        <div>
            <p>
                Sed non urna. Donec et ante. Phasellus eu ligula. Vestibulum sit amet
                purus. Vivamus hendrerit, dolor at aliquet laoreet, mauris turpis porttitor
                velit, faucibus interdum tellus libero ac justo. Vivamus non quam. In
                suscipit faucibus urna.
            </p>
        </div>
        <h3>Section 3</h3>
        <div>
            <p>
                Nam enim risus, molestie et, porta ac, aliquam ac, risus. Quisque lobortis.
                Phasellus pellentesque purus in massa. Aenean in pede. Phasellus ac libero
                ac tellus pellentesque semper. Sed ac felis. Sed commodo, magna quis
                lacinia ornare, quam ante aliquam nisi, eu iaculis leo purus venenatis dui.
            </p>
            <ul>
                <li>List item one</li>
                <li>List item two</li>
                <li>List item three</li>
            </ul>
        </div>
        <h3>Section 4</h3>
        <div>
            <p>
                Cras dictum. Pellentesque habitant morbi tristique senectus et netus
                et malesuada fames ac turpis egestas. Vestibulum ante ipsum primis in
                faucibus orci luctus et ultrices posuere cubilia Curae; Aenean lacinia
                mauris vel est.
            </p>
            <p>
                Suspendisse eu nisl. Nullam ut libero. Integer dignissim consequat lectus.
                Class aptent taciti sociosqu ad litora torquent per conubia nostra, per
                inceptos himenaeos.
            </p>
        </div>
    </div>

    <br>
</div>

<!-- Contents loaded from server is inserted here by javascript -->
<div class="main" id="content">

</div>

</body>
</html>